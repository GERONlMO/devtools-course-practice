#############################################
##### Testing
#############################################

set(prefix "${MODULE}")

# Test: Application can run without arguments and show help message
add_test(
    NAME ${prefix}_Can_Run
    COMMAND ${APPLICATION}
)
set_tests_properties(${prefix}_Can_Run PROPERTIES
    PASS_REGULAR_EXPRESSION "This is a Bulls and Cows application."
    LABELS "${prefix}")

# Test: Application shows error message for incorrect number of arguments
add_test(
    NAME ${prefix}_Incorrect_Argument_Number
    COMMAND ${APPLICATION} 1 2
)
set_tests_properties(${prefix}_Incorrect_Argument_Number PROPERTIES
    PASS_REGULAR_EXPRESSION "ERROR: Incorrect number of arguments."
    LABELS "${prefix}")

# Test: Application shows error message for negative difficulty level
add_test(
    NAME ${prefix}_Incorrect_Difficulty_Level
    COMMAND ${APPLICATION} -1
)
set_tests_properties(${prefix}_Incorrect_Difficulty_Level PROPERTIES
    PASS_REGULAR_EXPRESSION "ERROR: Difficulty level must be a positive integer."
    LABELS "${prefix}")

# Test: Application runs correctly with valid difficulty level
add_test(
    NAME ${prefix}_Valid_Difficulty_Level
    COMMAND ${APPLICATION} 4
)
set_tests_properties(${prefix}_Valid_Difficulty_Level PROPERTIES
    PASS_REGULAR_EXPRESSION "Welcome to Bulls and Cows game!"
    LABELS "${prefix}")

# Test: Application generates random guesses and outputs game results
add_test(
    NAME ${prefix}_Auto_Play
    COMMAND ${APPLICATION} 4
)
set_tests_properties(${prefix}_Auto_Play PROPERTIES
    PASS_REGULAR_EXPRESSION "Congratulations! You've guessed the number correctly."
    LABELS "${prefix}")

# Test: Invalid guess (not enough digits)
add_test(
    NAME ${prefix}_Invalid_Guess_Not_Enough_Digits
    COMMAND ${APPLICATION} 4
)
set_tests_properties(${prefix}_Invalid_Guess_Not_Enough_Digits PROPERTIES
    PASS_REGULAR_EXPRESSION "Invalid guess. Make sure it has 4 digits and contains only numbers."
    LABELS "${prefix}")

# Test: Invalid guess (contains non-numeric characters)
add_test(
    NAME ${prefix}_Invalid_Guess_Non_Numeric
    COMMAND ${APPLICATION} 4
)
set_tests_properties(${prefix}_Invalid_Guess_Non_Numeric PROPERTIES
    PASS_REGULAR_EXPRESSION "Invalid guess. Make sure it has 4 digits and contains only numbers."
    LABELS "${prefix}")

# Test: Valid guess (output Bulls and Cows)
add_test(
    NAME ${prefix}_Valid_Guess
    COMMAND ${APPLICATION} 4
)
set_tests_properties(${prefix}_Valid_Guess PROPERTIES
    PASS_REGULAR_EXPRESSION "Bulls: [0-4], Cows: [0-4]"
    LABELS "${prefix}")

# Test: Run out of attempts
add_test(
    NAME ${prefix}_Run_Out_Of_Attempts
    COMMAND ${APPLICATION} 4
)
set_tests_properties(${prefix}_Run_Out_Of_Attempts PROPERTIES
    PASS_REGULAR_EXPRESSION "Sorry, you've run out of attempts. The secret number was:"
    LABELS "${prefix}")
